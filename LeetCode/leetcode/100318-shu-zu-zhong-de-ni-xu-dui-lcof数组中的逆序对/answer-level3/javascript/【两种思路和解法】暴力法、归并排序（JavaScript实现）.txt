
## è§£æ³• 1: æš´åŠ›æ³•ï¼ˆTLEï¼‰

ç›´æ¥åŒé‡å¾ªç¯ï¼ŒæŒ¨ä¸ªæ£€æŸ¥æ˜¯å¦ä¸ºé€†åºå¯¹ã€‚ä»£ç å®ç°æ¯”è¾ƒç®€å•ï¼š

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var reversePairs = function(nums) {
    let res = 0;
    const length = nums.length;
    for (let i = 0; i < length; ++i) {
        for (let j = i + 1; j < length; ++j) {
            nums[i] > nums[j] && ++res;
        }
    }

    return res;
};
```

æ—¶é—´å¤æ‚åº¦æ˜¯$O(N^2)$ã€‚åœ¨ leetcode ä¸Šä¼š TLEï¼Œæ— æ³•é€šè¿‡ï¼ˆæ¯•ç«Ÿè¿™æ˜¯é“æ ‡æ³¨ã€Œå›°éš¾ã€çš„é¢˜ç›®ï¼‰ã€‚

## è§£æ³• 2: å½’å¹¶æ’åºï¼ˆæ­£ç¡®è§£æ³•ï¼‰

è¿™é¢˜çš„æ­£ç¡®è§£æ³•æ˜¯è¦å€ŸåŠ©å½’å¹¶æ’åºçš„æ€è·¯ï¼Œåœ¨å½’å¹¶çš„è¿‡ç¨‹ä¸­ï¼Œå¿«é€Ÿç»Ÿè®¡é€†åºå¯¹ã€‚è¿™ç§è§£æ³•æ¯”è¾ƒéš¾æƒ³åˆ°ï¼Œä½†æ˜¯åº”ç”¨å½’å¹¶æ’åºçš„é¢˜ç›®çœŸçš„ä¸å¤šï¼Œæ‰€ä»¥è¿™é¢˜å¾ˆæœ‰ç ”ç©¶å’Œæ”¶è—æ„ä¹‰ã€‚

æ ¸å¿ƒçš„è§£å†³é€»è¾‘éƒ½å°è£…åœ¨ findInversePairNum å‡½æ•°ä¸­ã€‚å®ƒçš„èŒèƒ½å°±æ˜¯ç»Ÿè®¡æ•°ç»„`arr[start, end]`èŒƒå›´ä¸­çš„é€†åºå¯¹ï¼Œå¹¶ä¸”ç»Ÿè®¡å®Œåï¼Œ`arr[start, end]`èŒƒå›´ä¸­çš„å…ƒç´ ä¼šè¢«æ’åºï¼ˆè¿™ç‚¹å’Œå½’å¹¶æ’åºçš„è¿‡ç¨‹ä¸€æ ·ï¼‰ã€‚

é‚£ä¹ˆå‡½æ•°åˆæ˜¯å¦‚ä½•å¿«é€Ÿç»Ÿè®¡é€†åºå¯¹çš„å‘¢ï¼Ÿå¤§ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š

-   é€’å½’è°ƒç”¨ï¼Œæ‹¿åˆ°å·¦å­æ•°ç»„å’Œå³å­æ•°ç»„çš„é€†åºå¯¹ï¼ˆæ­¤æ—¶ï¼Œå·¦å­æ•°ç»„å’Œå³å­æ•°ç»„ä¹Ÿéƒ½æ’åºå®Œæˆäº†ï¼‰
-   æŒ‡é’ˆ i å’Œ j åˆ†åˆ«æŒ‡å‘å·¦å­æ•°ç»„å’Œå³å­æ•°ç»„çš„æœ€å³ä¾§ï¼Œæ­¤æ—¶ä¼šæœ‰ 2 ç§æƒ…å†µï¼š
    -   `arr[i] > arr[j]`ï¼šé‚£ä¹ˆè¯´æ˜`arr[i]`å¤§äºå³å­æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ï¼Œé€†åºå¯¹å¢åŠ `j - start - length`ï¼Œå‘å·¦è¾¹ç§»åŠ¨æŒ‡é’ˆ i
    -   `arr[i] <= arr[j]`: å¯¹`arr[i]`æ¥è¯´ï¼Œä¸å­˜åœ¨é€†åºå¯¹ï¼Œå‘å·¦è¾¹ç§»åŠ¨æŒ‡é’ˆ j
-   i å’Œ j éå†å®Œå„è‡ªæ•°ç»„åï¼Œæœ€åè¿”å›é€†åºå¯¹ä¹‹å’Œå³å¯

ä»£ç å®ç°å¦‚ä¸‹ï¼š

```javascript
// acåœ°å€ï¼šhttps://leetcode-cn.com/problems/shu-zu-zhong-de-ni-xu-dui-lcof/
// åŸæ–‡åœ°å€ï¼šhttps://xxoo521.com/2020-03-12-reverse-pairs/
/**
 * @param {number[]} nums
 * @return {number}
 */
var reversePairs = function(nums) {
    return findInversePairNum(nums, 0, nums.length - 1);
};

/**
 * @param {number[]} arr
 * @param {number} start
 * @param {number} end
 */
function findInversePairNum(arr, start, end) {
    if (start >= end) return 0;

    const copy = new Array(end - start + 1);
    const length = Math.floor((end - start) / 2); // å·¦æ•°ç»„é•¿åº¦
    const leftNum = findInversePairNum(arr, start, start + length);
    const rightNum = findInversePairNum(arr, start + length + 1, end);

    let i = start + length;
    let j = end;
    let copyIndex = end - start;
    let num = 0;
    while (i >= start && j >= start + length + 1) {
        if (arr[i] > arr[j]) {
            num += j - start - length;
            copy[copyIndex--] = arr[i--];
        } else {
            copy[copyIndex--] = arr[j--];
        }
    }

    while (i >= start) {
        copy[copyIndex--] = arr[i--];
    }

    while (j >= start + length + 1) {
        copy[copyIndex--] = arr[j--];
    }

    for (let k = start; k <= end; ++k) {
        arr[k] = copy[k - start];
    }

    return num + leftNum + rightNum;
}
```

æ—¶é—´å¤æ‚åº¦æ˜¯$O(NlogN)$ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯$O(N)$ã€‚å¦‚æœè¿˜æ˜¯è§‰å¾—ä¸å¥½ç†è§£ï¼Œå¯ä»¥ä»¥æ•°ç»„ 7ã€5ã€6ã€4 ä¸ºä¾‹ï¼ŒæŒ‰ç…§å‰é¢è¿‡ç¨‹ï¼Œæ‰‹åŠ¨è®¡ç®—ä¸€ä¸‹ã€‚

## æ›´å¤šèµ„æ–™

**æ•´ç†ä¸æ˜“ï¼Œè‹¥å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªã€Œå…³æ³¨+ç‚¹èµã€ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘æ›´æ–°çš„åŠ¨åŠ›** ğŸ‘‡

-   **ğŸ“–Blogï¼š[å‰‘æŒ‡ Offer é¢˜è§£ + JS ä»£ç ](https://xxoo521.com/algorithm/)**
-   **ğŸ±Github ï¼š[https://github.com/dongyuanxin/blog](https://github.com/dongyuanxin/blog)**
-   **ğŸŒŸ å…¬ä¼—å·ï¼š[å¿ƒè°­åšå®¢](https://tva1.sinaimg.cn/large/006tNbRwly1g9xhhp50jpj31bi0hcju4.jpg)**
