å¯ä»¥ä»æœ€å¤§é«˜åº¦å¼€å§‹æšä¸¾ï¼Œå°†é›¨æ°´åŒºåŸŸè¿›è¡Œè®¡ç®—ã€‚
å¯¹äºæ¯ä¸ªæ­£åœ¨æšä¸¾çš„é«˜åº¦è®¾ä¸º curHeightï¼Œä»…æ¬¡äºè¯¥é«˜åº¦çš„å€¼ä¸º nextHeightã€‚ç‰¹åˆ«çš„ï¼Œå½“ curHeight ä¸ºæœ€å°é«˜åº¦æ—¶ï¼ŒnextHeight = 0ã€‚
è®¾ L ä¸ºä¸ä½äºnextHeightçš„æŸ±å­åæ ‡çš„æœ€å°å€¼ï¼ŒRä¸ºä¸ä½äºnextHeightçš„æŸ±å­åæ ‡çš„æœ€å¤§å€¼ã€‚
è®¾ count ä¸ºé«˜äºnextHeightæŸ±å­çš„æ•°é‡ã€‚
åˆ™å¾…è®¡ç®—åŒºåŸŸé¢ç§¯ä¸º area = (R-L+1) * (curHeight - nextHeight)
è¯¥åŒºåŸŸä¸­é›¨æ°´çš„æ•°é‡ä¸º sum = area - count*(curHeight - nextHeight)

åŒºåŸŸç¤ºæ„å¦‚ä¸‹ï¼š
![æ¥é›¨æ°´3.png](https://pic.leetcode-cn.com/6d6cda5bdb49505d3801f391714d6d1c49e2ebc3897cb6952dab7921609ac9d1-%E6%8E%A5%E9%9B%A8%E6%B0%B43.png)

æšä¸¾è¿‡ç¨‹å¦‚ä¸‹ï¼š

<![](https://pic.leetcode-cn.com/1cb631717cd0bd1f9a2bb26f58ed00932b7cd6bc0279bb339692d50e757ae43b-%E6%8E%A5%E9%9B%A8%E6%B0%B41.png),![](https://pic.leetcode-cn.com/72fc91728483158acdab266725423705469253f4d1213dd175e2e066399383d1-%E6%8E%A5%E9%9B%A8%E6%B0%B42.png),![](https://pic.leetcode-cn.com/b000c124ce7f3d81da51f9f92be28ef0b32ae744955aaa58ecf0e5c28e266714-%E6%8E%A5%E9%9B%A8%E6%B0%B43.png),![](https://pic.leetcode-cn.com/4f0d1c64493ed88e8830a4f7bef8a7d705903c37e72298223be26508918e185e-%E6%8E%A5%E9%9B%A8%E6%B0%B44.png)>

å®ç°æŠ€å·§ï¼šå¯ä»¥ä½¿ç”¨ä¸€ä¸ª map ç»Ÿè®¡æ¯ä¸ªé«˜åº¦æŸ±å­çš„å‡ºç°æ¬¡æ•°åŠåæ ‡ï¼Œç„¶åä½¿ç”¨ std::greater å®ç°mapçš„é™åºæ’åºã€‚
```
class Solution {
public:
    struct Info {
        int L, R;
        int cnt;
        Info() : L(0x7FFFFFFF), R(-1), cnt(0) {}
    };
    map<int, Info, greater<int>> data;
    int trap(vector<int>& height) {
        for(int i = 0, n = height.size(); i < n; i++) {
            auto &d = data[height[i]];
            d.L = min(d.L, i);
            d.R = max(d.R, i);
            d.cnt ++;
        }
        int L = height.size(), R = 0, cnt = 0;
        int res = 0;
        for(auto it = data.cbegin(); it != data.cend();) {
            L = min(L, it->second.L);
            R = max(R, it->second.R);
            cnt += it->second.cnt;
            int nowHeight = it->first;
            int nextHeight = 0;
            ++it;
            if(it == data.cend()) {
                nextHeight = 0;
            } else {
                nextHeight = it->first;
            }
            res += (R-L+1-cnt) * (nowHeight - nextHeight);
        }
        return res;
    }
};
```

# å¦‚æœæ„Ÿè§‰æœ‰ç‚¹æ„æ€ï¼Œå¯ä»¥å…³æ³¨ğŸ‘[HelloNebula](http://q8b35lo57.bkt.clouddn.com/qrcode_for_gh_6e5f8557b1f8_258.jpg)ğŸ‘
* **åˆ†äº«å‘¨èµ›é¢˜è§£**
* **åˆ†äº«è®¡ç®—æœºä¸“ä¸šè¯¾çŸ¥è¯†**
* **åˆ†äº«C++ç›¸å…³å²—ä½é¢è¯•é¢˜**
* **åˆ†äº«ä¸“ä¸šä¹¦ç±PDF**

