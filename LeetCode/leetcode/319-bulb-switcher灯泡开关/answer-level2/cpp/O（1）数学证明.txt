从题意很容易看出来，如果一个灯泡有奇数个约数，那么最后这个灯泡一定会亮着。
那么这个题目变成了**求1到n有多少个数约数为奇数个**。

在算术基本定理中，若正整数$N$被唯一分解为$N = p^{c_1}_1p^{c_2}_2...p^{c_m}_m$,其中$c_i$都是正整数，$p_i$都是质数，且满足$p_1<p_2<...<p_m$,则$N$的正约数集合可以写作：
$$
\{p^{c_1}_1p^{c_2}_2...p^{c_m}_m\},其中0\leq b_i\leq c_i
$$
$N$的正约数个数为：
$$
(c_1+1)*(c_2+1)*...(c_m+1)=\prod^{m}_{i=1}(c_i+1)
$$
如果N的约数为奇数个，那么$c_1+1,c_2+1,...c_m+1$肯定都是奇数，那么$c_1,c_2,...c_m$都是偶数
$$
N = p^{c_1}_1p^{c_2}_2...p^{c_m}_m = (p^{c_1/2}_1p^{c_2/2}_2...p^{c_m/2}_m)^2
$$
所以N是平方数。
从1到n中最多有$\sqrt n$个平方数。

只需要求n的平方根，所以时间复杂度是$O(1)$。

如果嫌弃数学公式表达麻烦难理解，可以参考评论区大神的说法一下就理解了。

```cpp
class Solution {
public:
    int bulbSwitch(int n) {
        return sqrt(n);
    }
};
```