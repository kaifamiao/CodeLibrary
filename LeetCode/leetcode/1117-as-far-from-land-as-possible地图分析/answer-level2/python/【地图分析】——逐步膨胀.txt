è¿™é“é¢˜æ¢ä¸ªæ€è·¯å°±å¾ˆç®€å•äº†â€”â€”
ä»¥åŽŸ[é™†åœ°]åŒºåŸŸä¸ºä¸­å¿ƒï¼Œé€æ­¥å‘å¤–æ‰©å¼ /è†¨èƒ€ï¼›æ¯æ¬¡[å¯¹å¤–]æ‰©å¼ /è†¨èƒ€ï¼Œåªè€ƒè™‘æœ€å¤–å›´çš„æ¯ä¸ªåæ ‡çš„ ðŸ‘† ðŸ‘‡ ðŸ‘ˆ ðŸ‘‰ 4 ä¸ªæ–¹å‘æ˜¯å¦ä¸º [æµ·æ´‹] åŒºåŸŸã€‚çŸ¥é“æ‰€æœ‰[æµ·æ´‹åŒºåŸŸ]è¢«[å é¢†]ã€‚
è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡è¿­ä»£ï¼Œæµ·æ´‹åˆ°é™†åœ°çš„æœ€å°è·ç¦» +1ï¼Œå¹¶ä¸”å¯¹äºŽæ‰€æœ‰[å¤§é™†å—]éƒ½æ˜¯ä¸€æ ·çš„æœ€å°è·ç¦»ï¼Œå› æ­¤ä¸å¿…æ‹…å¿ƒé‡å é—®é¢˜ã€‚

```python
class Solution:
    def maxDistance(self, grid: List[List[int]]) -> int:
        N = len(grid)
        if N == 1:
            return -1
        
        cnt0 = 0
        cnt1 = 0

        ceil_tocheck = set()    # åœ¨ä¸‹é¢çš„ while å¾ªçŽ¯ä¸­è¦æ£€æŸ¥çš„åæ ‡çš„é›†åˆ
        ceil_unchecked = set()  # å‰©ä¸‹æœªæ£€æŸ¥çš„[æµ·æ´‹]çš„åæ ‡é›†åˆ
        flags = [[False for j in range(N)] for i in range(N)] # ä¸€ä¸ª[æ ‡è®°]çŸ©é˜µï¼ŒåŒ grid ç­‰å¤§ï¼Œç”¨æ¥è®°å½•[è¯¥åæ ‡]æ˜¯å¦ç»è¿‡æ£€æŸ¥äº†

        for i in range(N):
            for j in range(N):
                if grid[i][j] == 0:
                    cnt0 += 1
                    ceil_unchecked.add((i, j)) # åˆå§‹åŒ–ï¼Œæœªæ£€æŸ¥çš„[æµ·æ´‹]çš„åæ ‡é›†åˆåŒ…æ‹¬æ‰€æœ‰çš„[æµ·æ´‹]åŒºåŸŸ
                else:
                    cnt1 += 1
                    ceil_tocheck.add((i, j))   # åˆå§‹åŒ–ï¼Œé¦–å…ˆä»ŽåŽŸ[é™†åœ°]åŒºåŸŸå¼€å§‹å‘å¤–[è†¨èƒ€]
                    flags[i][j] = True         # å¯¹[è†¨èƒ€]çš„èµ·ç‚¹è®¾ç½®æ ‡è®°
        
        # æ ¹æ®é¢˜æ„ï¼Œå…¨éƒ¨[é™†åœ°]æˆ–è€…å…¨éƒ¨[æµ·æ´‹]ï¼Œè¿”å›ž -1
        if cnt0 == N**2 or cnt1 == N**2:
            return -1
        
        dist = 0
        while ceil_unchecked: # åˆ°æ‰€æœ‰çš„åæ ‡éƒ½è¢«æ£€æŸ¥è¿‡ä¸ºæ­¢
            dist += 1

            ceil_tocheck_t = set()             # ç”¨äºŽå‚¨å¤‡ä¸‹ä¸€è½®çš„[è†¨èƒ€]èµ·ç‚¹çš„åæ ‡

            # éåŽ†æ¡£æ¬¡è¿­ä»£ä¸­æ¯ä¸€ä¸ªå¾…æ£€æŸ¥çš„åæ ‡
            for (i, j) in ceil_tocheck:
                # ä¾æ¬¡è€ƒè™‘å®ƒçš„[ä¸Š][ä¸‹][å·¦][å³]æ˜¯å¦ä¸ºæµ·æ´‹ï¼Œä¸”æœªè¢«æ ‡è®°
                # top
                if i > 0 and not flags[i-1][j]:
                    flags[i-1][j] = True
                    ceil_tocheck_t.add((i-1, j))
                    ceil_unchecked.remove((i-1, j))
                # down
                if i < N-1 and not flags[i+1][j]:
                    flags[i+1][j] = True
                    ceil_tocheck_t.add((i+1, j))
                    ceil_unchecked.remove((i+1, j))
                # left
                if j > 0 and not flags[i][j-1]:
                    flags[i][j-1] = True
                    ceil_tocheck_t.add((i, j-1))
                    ceil_unchecked.remove((i, j-1))
                # right
                if j < N-1 and not flags[i][j+1]:
                    flags[i][j+1] = True
                    ceil_tocheck_t.add((i, j+1))
                    ceil_unchecked.remove((i, j+1))
            
            ceil_tocheck = ceil_tocheck_t # æ›´æ–°ä¸‹ä¸€æ¬¡è¿­ä»£ä¸­è¦æ£€æŸ¥çš„åæ ‡çš„é›†åˆ
        
        return dist
```
- ä½¿ç”¨å“ˆå¸Œå¯ä»¥é«˜æ•ˆåšåˆ°ï¼šæ£€æŸ¥å­˜åœ¨æ€§ã€ç§»é™¤ï¼ˆå“ˆå¸Œçš„æ—¶é—´çš„å¤æ‚åº¦ä¸º O(1);
- å‰åŠéƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦ä¸º O(N^2)ï¼›åŽåŠéƒ¨åˆ†æ—¶é—´å¤æ‚åº¦ä¸º O(N).
